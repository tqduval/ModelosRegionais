}
# Choose one station to illustrate a prior distribution
gg <- "83942"
mu.kappa.r <- df_regional_kappa[df_regional_kappa[["gauges"]] == gg, "mu_kappa_r"]
sd.kappa.r <- df_regional_kappa[df_regional_kappa[["gauges"]] == gg, "sd_kappa_r"]
colors <- c("MLE" = "#cdc720", "GMLE-G" = "#12bce5", "GMLE-R" = "darkorange") # assign colors
model.names <- factor(names(colors), levels = c("MLE", "GMLE-G", "GMLE-R"))   # factor to stablish an order
plot.kappa <- ({
# Boxplot of standard deviation of kappa estimates
p1 <- df.kappa.ci %>%
mutate(model = factor(model, levels = c("l.gev", "gl.gev", "gl.gev.r")),
model = recode(model,  "l.gev" = "MLE", "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>% # recode changes individual factors
ggplot() +
# geom_jitter(aes(x = model, y = sd), alpha = 0.2, size = 1.5, color = "grey70") +
stat_boxplot(aes(x = model, y = sd), geom = "errorbar", width = 0.3) +
geom_boxplot(aes(x = model, y = sd, fill = model), linewidth = 0.5, outlier.shape = 4, outlier.size = 2, show.legend = FALSE) +
scale_fill_manual(values = colors) +
scale_x_discrete(labels = model.names) +
labs(x = "", y = expression("Desvio-padrão de" ~ hat(kappa))) +
theme_minimal() +
theme(legend.position =  "none",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p1
# Plot of reduction in standard deviation from MLE to the other two GML estimators
p2 <- df.kappa.sd.redct %>%
mutate(base.model = factor(base.model, levels = c("gl.gev", "gl.gev.r")),
base.model = recode(base.model,  "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>% # recode changes individual factors
ggplot(aes(x = sd.reduction, color = base.model)) +
stat_ecdf(geom = "smooth", linewidth = 0.7, show.legend = FALSE) +
labs(x = "Redução na incerteza [%]", y = "Estações [%]", color = "") +
coord_flip() +
scale_color_manual(values = c("GMLE-G" = "#12bce5", "GMLE-R" = "darkorange")) +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "none",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p2
# Prior distributions (geophysical and regional for one specific station)
p3 <- ggplot() +
# geom_blank(aes(color = "MLE"), inherit.aes = TRUE) +
geom_hline(aes(yintercept = 0, color = "MLE"), linewidth = 0.7, alpha = 0) +
stat_function(fun = fun.priori.beta, n = 1000, args = list(a = 0.5, mu = -0.10, sd = 0.122), linewidth = 0.7, aes(color = "GMLE-G")) +
stat_function(fun = fun.priori.beta, n = 1000, args = list(a = 0.5, mu = mu.kappa.r, sd = sd.kappa.r), linewidth = 0.7, aes(color = "GMLE-R")) +
scale_color_manual(values = colors,                                                 # use mapping from the colors object
breaks = model.names,                                            # breaks to order the elements
guide = guide_legend(override.aes = list(alpha = c(1, 1, 1)))) + # override.aes to make sure MLE appears in the legend
scale_x_continuous(limits = c(-0.5, 0.5)) +
labs(x = "κ", y = "π(κ)", color = "") +
theme_minimal() +
theme(legend.position = "none",
plot.background = element_rect(color = "white"),
legend.margin = margin(0, 0, 0, 0),
legend.justification = "center",
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p3
# Create final plot with patchwork
(p1 + p2)/p3 +
plot_layout(guides = "collect", heights = c(-1, -1)) &
plot_annotation(tag_levels = "a", tag_suffix = ")") &
theme(legend.position = "bottom")
}); plot.kappa
font.size <- 9
plot.kappa <- ({
# Boxplot of standard deviation of kappa estimates
p1 <- df.kappa.ci %>%
mutate(model = factor(model, levels = c("l.gev", "gl.gev", "gl.gev.r")),
model = recode(model,  "l.gev" = "MLE", "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>% # recode changes individual factors
ggplot() +
# geom_jitter(aes(x = model, y = sd), alpha = 0.2, size = 1.5, color = "grey70") +
stat_boxplot(aes(x = model, y = sd), geom = "errorbar", width = 0.3) +
geom_boxplot(aes(x = model, y = sd, fill = model), linewidth = 0.5, outlier.shape = 4, outlier.size = 2, show.legend = FALSE) +
scale_fill_manual(values = colors) +
scale_x_discrete(labels = model.names) +
labs(x = "", y = expression("Desvio-padrão de" ~ hat(kappa))) +
theme_minimal() +
theme(legend.position =  "none",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p1
# Plot of reduction in standard deviation from MLE to the other two GML estimators
p2 <- df.kappa.sd.redct %>%
mutate(base.model = factor(base.model, levels = c("gl.gev", "gl.gev.r")),
base.model = recode(base.model,  "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>% # recode changes individual factors
ggplot(aes(x = sd.reduction, color = base.model)) +
stat_ecdf(geom = "smooth", linewidth = 0.7, show.legend = FALSE) +
labs(x = "Redução na incerteza [%]", y = "Estações [%]", color = "") +
coord_flip() +
scale_color_manual(values = c("GMLE-G" = "#12bce5", "GMLE-R" = "darkorange")) +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "none",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p2
# Prior distributions (geophysical and regional for one specific station)
p3 <- ggplot() +
# geom_blank(aes(color = "MLE"), inherit.aes = TRUE) +
geom_hline(aes(yintercept = 0, color = "MLE"), linewidth = 0.7, alpha = 0) +
stat_function(fun = fun.priori.beta, n = 1000, args = list(a = 0.5, mu = -0.10, sd = 0.122), linewidth = 0.7, aes(color = "GMLE-G")) +
stat_function(fun = fun.priori.beta, n = 1000, args = list(a = 0.5, mu = mu.kappa.r, sd = sd.kappa.r), linewidth = 0.7, aes(color = "GMLE-R")) +
scale_color_manual(values = colors,                                                 # use mapping from the colors object
breaks = model.names,                                            # breaks to order the elements
guide = guide_legend(override.aes = list(alpha = c(1, 1, 1)))) + # override.aes to make sure MLE appears in the legend
scale_x_continuous(limits = c(-0.5, 0.5)) +
labs(x = "κ", y = "π(κ)", color = "") +
theme_minimal() +
theme(legend.position = "none",
plot.background = element_rect(color = "white"),
legend.margin = margin(0, 0, 0, 0),
legend.justification = "center",
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p3
# Create final plot with patchwork
(p1 + p2)/p3 +
plot_layout(guides = "collect", heights = c(-1, -1)) &
plot_annotation(tag_levels = "a", tag_suffix = ")") &
theme(legend.position = "bottom")
}); plot.kappa
df.kappa.ci %>%
mutate(model = factor(model, levels = c("l.gev", "gl.gev", "gl.gev.r")),
model = recode(model,  "l.gev" = "MLE", "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>% # recode changes individual factors
ggplot() +
# geom_jitter(aes(x = model, y = sd), alpha = 0.2, size = 1.5, color = "grey70") +
stat_boxplot(aes(x = model, y = sd), geom = "errorbar", width = 0.3) +
geom_boxplot(aes(x = model, y = sd, fill = model), linewidth = 0.5, outlier.shape = 4, outlier.size = 2, show.legend = FALSE) +
scale_fill_manual(values = colors) +
scale_x_discrete(labels = model.names) +
labs(x = "", y = expression("Desvio-padrão de" ~ hat(kappa))) +
theme_minimal() +
theme(legend.position =  "none",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size))
ggsave(filename = "Plotagens/separado/kappa.boxplot.png", plot = p1,
width = 160, height = 110, dpi = 200, units = "cm")
ggsave(filename = "Plotagens/separado/kappa.boxplot.png", plot = p1,
width = 160, height = 110, dpi = 200, units = "mm")
ggsave(filename = "Plotagens/separado/kappa.boxplot.png", plot = p1,
width = 120, height = 80, dpi = 200, units = "mm")
ggsave(filename = "Plotagens/separado/kappa.boxplot.png", plot = p1,
width = 160, height = 110, dpi = 200, units = "mm")
# Plot of reduction in standard deviation from MLE to the other two GML estimators
p2 <- df.kappa.sd.redct %>%
mutate(base.model = factor(base.model, levels = c("gl.gev", "gl.gev.r")),
base.model = recode(base.model,  "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>% # recode changes individual factors
ggplot(aes(x = sd.reduction, color = base.model)) +
stat_ecdf(geom = "smooth", linewidth = 0.7, show.legend = FALSE) +
labs(x = "Redução na incerteza [%]", y = "Estações [%]", color = "") +
coord_flip() +
scale_color_manual(values = c("GMLE-G" = "#12bce5", "GMLE-R" = "darkorange")) +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
theme(legend.position = "none",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p2
ggsave(filename = "Plotagens/separado/sigma.reduc.kappa.png", plot = p2,
width = 160, height = 110, dpi = 200, units = "mm")
# Prior distributions (geophysical and regional for one specific station)
p3 <- ggplot() +
# geom_blank(aes(color = "MLE"), inherit.aes = TRUE) +
geom_hline(aes(yintercept = 0, color = "MLE"), linewidth = 0.7, alpha = 0) +
stat_function(fun = fun.priori.beta, n = 1000, args = list(a = 0.5, mu = -0.10, sd = 0.122), linewidth = 0.7, aes(color = "GMLE-G")) +
stat_function(fun = fun.priori.beta, n = 1000, args = list(a = 0.5, mu = mu.kappa.r, sd = sd.kappa.r), linewidth = 0.7, aes(color = "GMLE-R")) +
scale_color_manual(values = colors,                                                 # use mapping from the colors object
breaks = model.names,                                            # breaks to order the elements
guide = guide_legend(override.aes = list(alpha = c(1, 1, 1)))) + # override.aes to make sure MLE appears in the legend
scale_x_continuous(limits = c(-0.5, 0.5)) +
labs(x = "κ", y = "π(κ)", color = "") +
theme_minimal() +
theme(legend.position = "none",
plot.background = element_rect(color = "white"),
legend.margin = margin(0, 0, 0, 0),
legend.justification = "center",
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p3
ggsave(filename = "Plotagens/separado/prioris.kappa.png", plot = p3,
width = 160, height = 110, dpi = 200, units = "mm")
p4 <- df.q.sd.redct %>%
mutate(base.model = factor(base.model, levels = c("gl.gev", "gl.gev.r")),
base.model = recode(base.model,  "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>%          # recode changes individual factors
filter(tempo.retorno == 50 & base.model == "GMLE-R") %>%                                          # keep only T = 50 yrs
arrange(sd.reduction) %>%                                                                         # arrange increasing
filter(!row_number() %in% 1:3) %>%                                                                # remove first three observations that are just insane
ggplot(aes(x = diff.kappa, y = sd.reduction, color = group)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linewidth = 0.2, linetype = "dashed", alpha = 0.8, color = "grey30") + # add axis centered on (0,0)
geom_vline(xintercept = 0, linewidth = 0.2, linetype = "dashed", alpha = 0.8, color = "grey30") + # x axis
annotate("curve", xend = -0.33, x = -0.2, yend = -0.8, y = -0.71,                                 # arrow indicating points outside plot limits
arrow = arrow(type = "open", length = unit(1.8, "mm")),
linewidth = 0.35, curvature = 0.1) +
annotate("text", x = -0.21, y = -0.7, label = "02955006\n02753016\n03055005",                     # stations outside plot limits
hjust = -0.3, family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_color_manual(values = colors.tr,
labels = c("A" = expression(kappa[GMLE-R] < kappa[MLE]),                       # change the label values
"B" = expression(kappa[GMLE-R] > kappa[MLE]))) +
# scale_color_manual(values = colors.tr, labels = c("A" = "GMLE-R < MLE", "B" = "GMLE-R > MLE")) +
scale_y_continuous(labels = scales::percent, limits = c(-0.8, 0.7)) +
labs(x = "Diferença entre estimativas de κ", y = "Redução na incerteza [%]", color = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
# aspect.ratio = 1,                                                                           # ensure square plot shape when plotting
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p4
colors.tr <- c("A" = "#bf4f10", "B" = "#ffc727") # set colors for plot
kappa.gg.fq <- c("l.gev" = sapply(df.fq.par$par.l.gev, function(p) p[[3]]), "gl.gev.r" = sapply(df.fq.par$par.gl.gev.r, function(p) p[[3]]))
annotate.font.size <- 3
p4 <- df.q.sd.redct %>%
mutate(base.model = factor(base.model, levels = c("gl.gev", "gl.gev.r")),
base.model = recode(base.model,  "gl.gev" = "GMLE-G", "gl.gev.r" = "GMLE-R")) %>%          # recode changes individual factors
filter(tempo.retorno == 50 & base.model == "GMLE-R") %>%                                          # keep only T = 50 yrs
arrange(sd.reduction) %>%                                                                         # arrange increasing
filter(!row_number() %in% 1:3) %>%                                                                # remove first three observations that are just insane
ggplot(aes(x = diff.kappa, y = sd.reduction, color = group)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linewidth = 0.2, linetype = "dashed", alpha = 0.8, color = "grey30") + # add axis centered on (0,0)
geom_vline(xintercept = 0, linewidth = 0.2, linetype = "dashed", alpha = 0.8, color = "grey30") + # x axis
annotate("curve", xend = -0.33, x = -0.2, yend = -0.8, y = -0.71,                                 # arrow indicating points outside plot limits
arrow = arrow(type = "open", length = unit(1.8, "mm")),
linewidth = 0.35, curvature = 0.1) +
annotate("text", x = -0.21, y = -0.7, label = "02955006\n02753016\n03055005",                     # stations outside plot limits
hjust = -0.3, family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_color_manual(values = colors.tr,
labels = c("A" = expression(kappa[GMLE-R] < kappa[MLE]),                       # change the label values
"B" = expression(kappa[GMLE-R] > kappa[MLE]))) +
# scale_color_manual(values = colors.tr, labels = c("A" = "GMLE-R < MLE", "B" = "GMLE-R > MLE")) +
scale_y_continuous(labels = scales::percent, limits = c(-0.8, 0.7)) +
labs(x = "Diferença entre estimativas de κ", y = "Redução na incerteza [%]", color = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
# aspect.ratio = 1,                                                                           # ensure square plot shape when plotting
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p4
ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p3,
width = 160, height = 110, dpi = 200, units = "mm")
ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
width = 160, height = 110, dpi = 200, units = "mm")
# Contabilizar estações
df.q.sd.redct %>% filter(tempo.retorno == 50 & base.model == "gl.gev.r") %>%
filter(diff.kappa < 0 & sd.reduction < 0) %>% nrow # 34
# ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
#        width = 160, height = 110, dpi = 200, units = "mm")
#
# Gráfico de frequência p/ estações cujo |diff.kappa| é próximo de 0
p5 <- ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
annotate("text", label = expression(kappa[MLE] == 0.0528), x = 1, y = 265, hjust = -0.05,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = expression(kappa[GMLE-R] == 0.0538), x = 1, y = 254, hjust = -0.04,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = paste("Tamanho da série:", nrow(df.fq.observed), "anos"), x = 1, y = 243, hjust = -0.03,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
# ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
#        width = 160, height = 110, dpi = 200, units = "mm")
#
# Gráfico de frequência p/ estações cujo |diff.kappa| é próximo de 0
p5 <- ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
annotate("text", label = expression(kappa[MLE] == 0.0528), x = 1, y = 265, hjust = -0.05,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = expression(kappa[GMLE-R] == 0.0538), x = 1, y = 254, hjust = -0.04,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = paste("Tamanho da série:", nrow(df.fq.observed), "anos"), x = 1, y = 243, hjust = -0.03,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
annotate("text", label = expression(kappa[MLE] == 0.0528), x = 1, y = 265, hjust = -0.05,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = expression(kappa[GMLE-R] == 0.0538), x = 1, y = 254, hjust = -0.04,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = paste("Tamanho da série:", nrow(df.fq.observed), "anos"), x = 1, y = 243, hjust = -0.03,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size))
# ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
#        width = 160, height = 110, dpi = 200, units = "mm")
#
# Gráfico de frequência p/ estações cujo |diff.kappa| é próximo de 0
p5 <- ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
annotate("text", label = as.character(expression(kappa[MLE] == 0.0528)), x = 1, y = 265, hjust = -0.05,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = as.character(expression(kappa[GMLE-R] == 0.0538)), x = 1, y = 254, hjust = -0.04,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = paste("Tamanho da série:", nrow(df.fq.observed), "anos"), x = 1, y = 243, hjust = -0.03,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
# ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
#        width = 160, height = 110, dpi = 200, units = "mm")
#
# Gráfico de frequência p/ estações cujo |diff.kappa| é próximo de 0
p5 <- ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
geom_text(aes(x = 1, y = 265, label = "kappa[MLE]==0.0528"),
parse = TRUE,
hjust = -0.05,
family = "Times New Roman",
size = unit(annotate.font.size, "mm")) +
# annotate("text", label = expression(kappa[MLE] == 0.0528), x = 1, y = 265, hjust = -0.05,
# family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = expression(kappa[GMLE-R] == 0.0538), x = 1, y = 254, hjust = -0.04,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = paste("Tamanho da série:", nrow(df.fq.observed), "anos"), x = 1, y = 243, hjust = -0.03,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
# ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
#        width = 160, height = 110, dpi = 200, units = "mm")
#
# Gráfico de frequência p/ estações cujo |diff.kappa| é próximo de 0
p5 <- ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
geom_text(aes(x = 1, y = 265, label = "kappa[MLE]==0.0528"),
parse = TRUE,
hjust = -0.05,
family = "Times New Roman",
size = unit(annotate.font.size, "mm")) +
# annotate("text", label = expression(kappa[MLE] == 0.0528), x = 1, y = 265, hjust = -0.05,
# family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
# annotate("text", label = expression(kappa[GMLE-R] == 0.0538), x = 1, y = 254, hjust = -0.04,
#          family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
annotate("text", label = paste("Tamanho da série:", nrow(df.fq.observed), "anos"), x = 1, y = 243, hjust = -0.03,
family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
# ggsave(filename = "Plotagens/separado/sigma.q.reduc.png", plot = p4,
#        width = 160, height = 110, dpi = 200, units = "mm")
#
# Gráfico de frequência p/ estações cujo |diff.kappa| é próximo de 0
p5 <- ggplot() +
geom_ribbon(data = df.fq.estimated %>% filter(model == "l.gev"), alpha = 0.1, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% MLE", fill = "IC 95% MLE"), color = "black") +
geom_ribbon(data = df.fq.estimated %>% filter(model == "gl.gev.r"), alpha = 0.3, linewidth = 0.4,
aes(x = tempo.retorno, ymin = ic.l, ymax = ic.u,
linetype = "IC 95% GMLE-R", fill = "IC 95% GMLE-R"), color = "black") +
geom_line(data = df.fq.estimated %>% filter(model == "gl.gev.r"),
aes(x = tempo.retorno, y = q, linewidth = "Estimado"), color = "black") +
geom_point(data = df.fq.observed,
aes(x = tr, y = peak_24h, color = "Observado", shape = "Observado")) +
scale_x_log10(breaks = c(1, 10, 20, 30, 50, 100, 200, 300, 500),
labels = c("1", "10", "20", "30", "50", "100", "200", "300", "500")) +
geom_text(aes(x = 1, y = 265, label = "kappa[MLE]==0.0528"), parse = TRUE, # parse interprets expressions in labels
hjust = -0.05, family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
geom_text(aes(x = 1, y = 254, label = "kappa[GMLE-R]==0.0538"), parse = TRUE,
hjust = -0.04, family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
geom_text(aes(x = 1, y = 243, label = paste('Tamanho da série:', nrow(df.fq.observed), 'anos')),
hjust = -0.03, family = "Times New Roman", size = unit(annotate.font.size, "mm")) +
scale_linetype_manual(values = c("Estimado" = "solid", "IC 95% GMLE-R" = "solid", "IC 95% MLE" = "dashed")) +
scale_linewidth_manual(values = c("Estimado" = 1)) +
scale_color_manual(values = c("Observado" = "red")) +
scale_shape_manual(values = c("Observado" = 8)) +
scale_fill_manual(values = c("IC 95% GMLE-R" = "grey20", "IC 95% MLE" = "grey50")) +
labs(x = "Tempo de retorno [anos]", y = "Precipitação diária máxima anual [mm]",
color = "", shape = "", fill = "", linetype = "", linewidth = "") +
theme_minimal() +
theme(legend.position = "bottom",
plot.background = element_rect(color = "white"),
panel.border = element_rect(color = "black", fill = NA),
text = element_text(family = "Times New Roman", color = "black", size = font.size)); p5
ggsave(filename = "Plotagens/separado/freq.plot.png", plot = p5,
width = 160, height = 110, dpi = 200, units = "mm")
